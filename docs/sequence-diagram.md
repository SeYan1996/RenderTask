# 渲染任务编排系统时序图

## 创建渲染任务

```
+--------+     +--------+     +--------+     +--------+
| 客户端 |     | API    |     | DynamoDB|     | SQS    |
+--------+     +--------+     +--------+     +--------+
    |             |              |              |
    | POST /jobs  |              |              |
    |------------>|              |              |
    |             |              |              |
    |             | 验证请求数据  |              |
    |             |------------->|              |
    |             |              |              |
    |             | 保存任务信息  |              |
    |             |------------->|              |
    |             |              |              |
    |             | 发送任务ID   |              |
    |             |------------------------------>|
    |             |              |              |
    | 返回jobId   |              |              |
    |<------------|              |              |
    |             |              |              |
```

## 处理渲染任务

```
+--------+     +--------+     +--------+     +--------+     +--------+
| Worker |     | SQS    |     | DynamoDB|     | S3     |     | 渲染引擎 |
+--------+     +--------+     +--------+     +--------+     +--------+
    |             |              |              |              |
    | 获取任务    |              |              |              |
    |<------------|              |              |              |
    |             |              |              |              |
    | 删除消息    |              |              |              |
    |------------>|              |              |              |
    |             |              |              |              |
    | 更新状态为PROCESSING |     |              |              |
    |----------------------------------------->|              |
    |             |              |              |              |
    | 渲染任务    |              |              |              |
    |------------------------------------------------------->|
    |             |              |              |              |
    | 渲染结果    |              |              |              |
    |<-------------------------------------------------------|
    |             |              |              |              |
    | 上传结果    |              |              |              |
    |----------------------------------------->|              |
    |             |              |              |              |
    | 更新状态为COMPLETED |      |              |              |
    |----------------------------------------->|              |
    |             |              |              |              |
```

## 查询任务状态

```
+--------+     +--------+     +--------+
| 客户端 |     | API    |     | DynamoDB|
+--------+     +--------+     +--------+
    |             |              |
    | GET /jobs/{jobId} |        |
    |------------>|              |
    |             |              |
    |             | 获取任务信息  |
    |             |------------->|
    |             |              |
    |             | 返回任务信息  |
    |             |<-------------|
    |             |              |
    | 返回任务状态  |              |
    |<------------|              |
    |             |              |
``` 